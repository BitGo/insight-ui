/* @generated */
/*! insight-ui 0.4.0 */
var defaultCurrency=localStorage.getItem("insight-currency")||"RMG";angular.module("insight",["ngAnimate","ngResource","ngRoute","ngProgress","ui.bootstrap","monospaced.qrcode","angularMoment","insight.system","insight.socket","insight.blocks","insight.transactions","insight.address","insight.search","insight.status","insight.notify","insight.connection","insight.currency","insight.messages","insight.network","insight.validators","ngRaven"]),angular.module("insight.system",[]),angular.module("insight.socket",[]),angular.module("insight.blocks",[]),angular.module("insight.transactions",[]),angular.module("insight.address",[]),angular.module("insight.search",[]),angular.module("insight.status",[]),angular.module("insight.connection",[]),angular.module("insight.currency",[]),angular.module("insight.messages",[]),angular.module("insight.network",[]),angular.module("insight.validators",[]),angular.module("insight.notify",[]),angular.module("insight.address").controller("AddressController",["$scope","$rootScope","$routeParams","$location","Address","getSocket","NotifyService",function($scope,$rootScope,$routeParams,$location,Address,getSocket,NotifyService){var socket=getSocket($scope),addrStr=$routeParams.addrStr,_startSocket=function(){socket.on("bitcoind/addresstxid",function(data){if(data.address===addrStr){$rootScope.$broadcast("tx",data.txid);var base=document.querySelector("base"),beep=new Audio(base.href+"/sound/transaction.mp3");beep.play()}}),socket.emit("subscribe","bitcoind/addresstxid",[addrStr])},_stopSocket=function(){socket.emit("unsubscribe","bitcoind/addresstxid",[addrStr])};socket.on("connect",function(){_startSocket()}),$scope.$on("$destroy",function(){_stopSocket()}),$scope.params=$routeParams,$scope.findOne=function(){$rootScope.currentAddr=$routeParams.addrStr,_startSocket(),Address.get({addrStr:$routeParams.addrStr},function(address){$rootScope.titleDetail=address.addrStr.substring(0,7)+"...",$scope.address=address},function(e){400===e.status?NotifyService.error("Invalid Address: "+$routeParams.addrStr):503===e.status?NotifyService.error("Backend Error. "+e.data):NotifyService.error("Address Not Found"),$location.path("/")})}}]),angular.module("insight.blocks").controller("BlocksController",["$scope","$rootScope","$routeParams","$location","Global","Block","Blocks","BlockByHeight","NotifyService",function($scope,$rootScope,$routeParams,$location,Global,Block,Blocks,BlockByHeight,NotifyService){$scope.global=Global,$scope.loading=!1,$scope.goTo=function(path){$location.path(path)},$routeParams.blockHeight&&BlockByHeight.get({blockHeight:$routeParams.blockHeight},function(hash){$location.path("/block/"+hash.blockHash)},function(){NotifyService.error("Bad Request"),$location.path("/")});var _formatTimestamp=function(date){var yyyy=date.getUTCFullYear().toString(),mm=(date.getUTCMonth()+1).toString(),dd=date.getUTCDate().toString();return yyyy+"-"+(mm[1]?mm:"0"+mm[0])+"-"+(dd[1]?dd:"0"+dd[0])};$scope.$watch("dt",function(newValue,oldValue){newValue!==oldValue&&$location.path("/blocks-date/"+_formatTimestamp(newValue))}),$scope.openCalendar=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.humanSince=function(time){var m=moment.unix(time).startOf("day"),b=moment().startOf("day");return m.max().from(b)},$scope.list=function(){if($scope.loading=!0,$routeParams.blockDate&&($scope.detail="On "+$routeParams.blockDate),$routeParams.startTimestamp){var d=new Date(1e3*$routeParams.startTimestamp),m=d.getMinutes();10>m&&(m="0"+m),$scope.before=" before "+d.getHours()+":"+m}$rootScope.titleDetail=$scope.detail,Blocks.get({blockDate:$routeParams.blockDate,startTimestamp:$routeParams.startTimestamp},function(res){$scope.loading=!1,$scope.blocks=res.blocks,$scope.pagination=res.pagination})},$scope.findOne=function(){$scope.loading=!0,Block.get({blockHash:$routeParams.blockHash},function(block){$rootScope.titleDetail=block.height,$rootScope.flashMessage=null,$scope.loading=!1,$scope.block=block},function(e){400===e.status?NotifyService.error("Invalid Transaction ID: "+$routeParams.txId):503===e.status?NotifyService.error("Backend Error. "+e.data):NotifyService.error("Block Not Found"),$location.path("/")})},$scope.params=$routeParams}]),angular.module("insight.connection").controller("ConnectionController",["$scope","$window","Status","PeerSync",function($scope,$window,Status,PeerSync){$scope.apiOnline=!0,$scope.serverOnline=!0,$scope.clienteOnline=!0,$scope.getConnStatus=function(){PeerSync.get({},function(peer){$scope.apiOnline=peer.connected,$scope.host=peer.host,$scope.port=peer.port},function(){$scope.apiOnline=!1})},$window.addEventListener("offline",function(){$scope.$apply(function(){$scope.clienteOnline=!1})},!0),$window.addEventListener("online",function(){$scope.$apply(function(){$scope.clienteOnline=!0})},!0)}]),angular.module("insight.currency").controller("CurrencyController",["$scope","$rootScope","Currency",function($scope,$rootScope,Currency){$rootScope.currency.symbol=defaultCurrency;var _roundFloat=function(x,n){return parseInt(n,10)&&parseFloat(x)||(n=0),Math.round(x*Math.pow(10,n))/Math.pow(10,n)};$rootScope.currency.getConvertion=function(value){if(value=1*value,!isNaN(value)&&"undefined"!=typeof value&&null!==value){if(0===value)return"0 "+this.symbol;var response;return"USD"===this.symbol?response=_roundFloat(value*this.factor,2):"mBTC"===this.symbol?(this.factor=1e3,response=_roundFloat(value*this.factor,5)):"bits"===this.symbol?(this.factor=1e6,response=_roundFloat(value*this.factor,2)):(this.factor=1,response=value),1e-7>response&&(response=response.toFixed(8)),response+" "+this.symbol}return"value error"},$scope.setCurrency=function(currency){$rootScope.currency.symbol=currency,localStorage.setItem("insight-currency",currency),"USD"===currency?Currency.get({},function(res){$rootScope.currency.factor=$rootScope.currency.bitstamp=res.data.bitstamp}):"mBTC"===currency?$rootScope.currency.factor=1e3:"bits"===currency?$rootScope.currency.factor=1e6:$rootScope.currency.factor=1},Currency.get({},function(res){$rootScope.currency.factor=$rootScope.currency.bitstamp=res.data.bitstamp})}]),angular.module("insight.system").controller("FooterController",["$scope","Version",function($scope,Version){var _getVersion=function(){Version.get({},function(res){$scope.version=res.version})};$scope.version=_getVersion()}]),angular.module("insight.system").controller("HeaderController",["$scope","$rootScope","$uibModal","Global","Block","$location",function($scope,$rootScope,$uibModal,Global,Block,$location){$scope.global=Global,$scope.isTestnet=function(){return Global.info.testnet},$scope.isActive=function(route){return $location.path().indexOf(route)>=0},$rootScope.currency={factor:1,bitstamp:0,symbol:"RMG"},$scope.openScannerModal=function(){$uibModal.open({templateUrl:"scannerModal.html",controller:"ScannerController"})},$rootScope.isCollapsed=!0}]);var TRANSACTION_DISPLAYED=5,BLOCKS_DISPLAYED=5;angular.module("insight.system").controller("IndexController",["$scope","$location","$interval","$timeout","Global","Blocks","LatestBlocks","LatestTransactions","AdminInfo",function($scope,$location,$interval,$timeout,Global,Blocks,LatestBlocks,LatestTransactions,AdminInfo){$scope.totalSupply=null,$scope.validatingNodes=null,$scope.blocksPollingConfig={throttling:!1},$scope.txPollingConfig={throttling:!1},AdminInfo.get({},function(data){$scope.totalSupply=data.totalsupply,$scope.validatingNodes=data.validatekeys.length}),$scope.global=Global,$scope.goTo=function(path){$location.path(path)},$scope.preventDefault=function(e){return e.stopPropagation()},$scope.handleFetchError=function(err,config,callback){return 0==err.status||408===err.status||504===err.status?callback():void(config.throttling||(config.throttling=!0,$timeout(function(){config.throttling=!1,callback()},3e3)))},$scope.updateWithLastBlock=function(block){if(block&&block.height){if($scope.blocks.length&&$scope.blocks[0].height+1<block.height)return $scope._getBlocks();$scope.blocks.unshift(block),$scope.blocks=$scope.blocks.splice(0,BLOCKS_DISPLAYED)}},$scope._getLatestBlock=function(){LatestBlocks.get().$promise.then($scope.updateWithLastBlock).then($scope._getLatestBlock)["catch"](function(err){$scope.handleFetchError(err,$scope.blocksPollingConfig,$scope._getLatestBlock)})},$scope._getBlocks=function(){Blocks.get({limit:BLOCKS_DISPLAYED}).$promise.then(function(res){$scope.blocks=res.blocks})},$scope.updateWithLastTx=function(tx){tx&&tx.txid&&($scope.txs.unshift(tx),$scope.txs=$scope.txs.splice(0,TRANSACTION_DISPLAYED))},$scope._getLatestTransaction=function(){LatestTransactions.get().$promise.then($scope.updateWithLastTx).then($scope._getLatestTransaction)["catch"](function(err){$scope.handleFetchError(err,$scope.txPollingConfig,$scope._getLatestTransaction)})},$scope.humanSince=function(time){var m=moment.unix(time);return m.max().fromNow()},$scope.txs=[],$scope.blocks=[],$scope._getLatestBlock(),$scope._getLatestTransaction(),$scope._getBlocks()}]),angular.module("insight.network").controller("NetworkController",["$scope","$location","networks","Status",function($scope,$location,networks,Status){function getNetworkOptions(){var all=$scope.networks.slice(0),selectedIndex=all.indexOf($scope.selectedNetwork);return selectedIndex>=0&&all.splice(selectedIndex,1),all}$scope.networks=Object.keys(networks),$scope.selectedNetwork="",Status.get({},function(d){$scope.selectedNetwork="livenet"===d.info.network?"mainnet":d.info.network,$scope.networkOptions=getNetworkOptions()}),$scope.changeNetwork=function(network){}}]),angular.module("insight.system").controller("ScannerController",["$scope","$rootScope","$uibModalInstance","Global","NotifyService",function($scope,$rootScope,$uibModalInstance,Global,NotifyService){$scope.global=Global;var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,$scope.isMobile=isMobile.any(),$scope.scannerLoading=!1;var cameraInput,video,canvas,$video,context,localMediaStream,$searchInput=angular.element(document.getElementById("search")),_scan=function(evt){if($scope.isMobile){$scope.scannerLoading=!0;var files=evt.target.files;if(1===files.length&&0===files[0].type.indexOf("image/")){var file=files[0],reader=new FileReader;reader.onload=function(theFile){return function(e){var mpImg=new MegaPixImage(file);mpImg.render(canvas,{maxWidth:200,maxHeight:200,orientation:6}),setTimeout(function(){qrcode.width=canvas.width,qrcode.height=canvas.height,qrcode.imagedata=context.getImageData(0,0,qrcode.width,qrcode.height);try{qrcode.decode()}catch(e){alert(e)}},1500)}}(file),reader.readAsDataURL(file)}}else{if(localMediaStream){context.drawImage(video,0,0,300,225);try{qrcode.decode()}catch(e){}}setTimeout(_scan,500)}},_successCallback=function(stream){video.src=window.URL&&window.URL.createObjectURL(stream)||stream,localMediaStream=stream,video.play(),setTimeout(_scan,1e3)},_stopTracks=function(){localMediaStream&&localMediaStream.getTracks&&localMediaStream.getTracks()[0].stop(),localMediaStream&&localMediaStream.stop&&localMediaStream.stop()},_scanStop=function(){$scope.scannerLoading=!1,$uibModalInstance.close(),$scope.isMobile||(_stopTracks(),localMediaStream=null,video.src="")},_videoError=function(err){NotifyService.info("Camera feature no longer works on insecure origins. To use this feature, you should consider switching your application to a secure origin, such as HTTPS."),_scanStop()};qrcode.callback=function(data){_scanStop();var str=0===data.indexOf("bitcoin:")?data.substring(8):data;console.log("QR code detected: "+str),$searchInput.val(str).triggerHandler("change").triggerHandler("submit")},$scope.cancel=function(){_scanStop()},$uibModalInstance.opened.then(function(){$rootScope.isCollapsed=!0,setTimeout(function(){canvas=document.getElementById("qr-canvas"),context=canvas.getContext("2d"),$scope.isMobile?(cameraInput=document.getElementById("qrcode-camera"),cameraInput.addEventListener("change",_scan,!1)):(video=document.getElementById("qrcode-scanner-video"),$video=angular.element(video),canvas.width=300,canvas.height=225,context.clearRect(0,0,300,225),navigator.getUserMedia({video:!0},_successCallback,_videoError))},500)})}]),angular.module("insight.search").controller("SearchController",["$scope","$routeParams","$location","$timeout","Global","Block","Transaction","Address","BlockByHeight",function($scope,$routeParams,$location,$timeout,Global,Block,Transaction,Address,BlockByHeight){$scope.global=Global,$scope.loading=!1;var _badQuery=function(){$scope.badQuery=!0,$timeout(function(){$scope.badQuery=!1},2e3)},_resetSearch=function(){$scope.q="",$scope.loading=!1};$scope.search=function(){var q=$scope.q;$scope.badQuery=!1,$scope.loading=!0,Block.get({blockHash:q},function(){_resetSearch(),$location.path("block/"+q)},function(){Transaction.get({txId:q},function(){_resetSearch(),$location.path("tx/"+q)},function(){Address.get({addrStr:q},function(){_resetSearch(),$location.path("address/"+q)},function(){isFinite(q)?BlockByHeight.get({blockHeight:q},function(hash){_resetSearch(),$location.path("/block/"+hash.blockHash)},function(){$scope.loading=!1,_badQuery()}):($scope.loading=!1,_badQuery())})})})}}]),angular.module("insight.transactions").controller("transactionsController",["$scope","$rootScope","$routeParams","$location","Global","Transaction","TransactionsByBlock","TransactionsByAddress","NotifyService",function($scope,$rootScope,$routeParams,$location,Global,Transaction,TransactionsByBlock,TransactionsByAddress,NotifyService){$scope.global=Global,$scope.loading=!1,$scope.loadedBy=null,$scope.adminInfo={issue_thread_transactions:{displayName:"Issuance Transaction",type:"issue_thread_transactions"},provision_transactions:{displayName:"Provision Transactions",type:"provisioning_transactions"},root_thread:{displayName:"Root Thread",type:"root_thread"},issue_rmg:{displayName:"Issue RMG",type:"issue_rmg"},destroy_rmg:{displayName:"Destroy RMG",type:"destroy_rmg"},issue_key_add:{displayName:"Add Issuer Key",type:"issue_key_add"},issue_key_revoke:{displayName:"Revoke Issuer key",type:"issue_key_revoke"},provision_key_add:{displayName:"Add Provisioner Key",type:"provision_key_add"},provision_key_revoke:{displayName:"Revoke Provisioner Key",type:"provision_key_revoke"},validate_key_add:{displayName:"Add Validator Key",type:"validate_key_add"},validate_key_revoke:{displayName:"Revoke Validator Key",type:"validate_key_revoke"},asp_key_add:{displayName:"Add ASP Key",type:"asp_key_add"},asp_key_revoke:{displayName:"Revoke ASP Key",type:"asp_key_revoke"}};var pageNum=0,pagesTotal=1,COIN=1e8,_aggregateItems=function(items){if(!items)return[];for(var l=items.length,ret=[],tmp={},i=0;l>i;i++){var notAddr=!1;if(items[i].scriptSig&&!items[i].addr&&(items[i].addr="Non standard",items[i].notAddr=!0,notAddr=!0),items[i].scriptPubKey&&!items[i].scriptPubKey.addresses&&(items[i].scriptPubKey.addresses=["Non standard"],items[i].notAddr=!0,notAddr=!0),items[i].scriptPubKey&&items[i].scriptPubKey.addresses.length>1)items[i].addr=items[i].scriptPubKey.addresses.join(","),ret.push(items[i]);else{var addr=items[i].addr||items[i].scriptPubKey&&items[i].scriptPubKey.addresses[0];tmp[addr]||(tmp[addr]={},tmp[addr].valueSat=0,tmp[addr].count=0,tmp[addr].addr=addr,tmp[addr].items=[]),tmp[addr].isSpent=items[i].spentTxId,tmp[addr].doubleSpentTxID=tmp[addr].doubleSpentTxID||items[i].doubleSpentTxID,tmp[addr].doubleSpentIndex=tmp[addr].doubleSpentIndex||items[i].doubleSpentIndex,tmp[addr].dbError=tmp[addr].dbError||items[i].dbError,tmp[addr].valueSat+=Math.round(items[i].value*COIN),tmp[addr].items.push(items[i]),tmp[addr].notAddr=notAddr,items[i].unconfirmedInput&&(tmp[addr].unconfirmedInput=!0),tmp[addr].count++}}return angular.forEach(tmp,function(v){v.value=v.value||parseInt(v.valueSat)/COIN,ret.push(v)}),ret},_processTX=function(tx){tx.vinSimple=_aggregateItems(tx.vin),tx.voutSimple=_aggregateItems(tx.vout)},_paginate=function(data){$scope.loading=!1,pagesTotal=data.pagesTotal,pageNum+=1,data.txs.forEach(function(tx){_processTX(tx),$scope.txs.push(tx)})},_byBlock=function(){TransactionsByBlock.get({block:$routeParams.blockHash,pageNum:pageNum},function(data){_paginate(data)})},_byAddress=function(){TransactionsByAddress.get({address:$routeParams.addrStr,pageNum:pageNum},function(data){_paginate(data)})},_findTx=function(txid){Transaction.get({txId:txid},function(tx){$rootScope.titleDetail=tx.txid.substring(0,7)+"...",$scope.tx=tx,_processTX(tx),$scope.txs.unshift(tx)},function(e){400===e.status?NotifyService.error("Invalid Transaction ID: "+$routeParams.txId):503===e.status?NotifyService.error("Backend Error. "+e.data):NotifyService.error("Transaction Not Found"),$location.path("/")})};$scope.isFundsOperation=function(){return $scope.tx.adminInfo.type===$scope.adminInfo.issue_rmg.type||$scope.tx.adminInfo.type===$scope.adminInfo.destroy_rmg.type},$scope.isAddingOrRemovingKeys=function(){return $scope.tx.adminInfo.type===$scope.adminInfo.issue_key_add.type||$scope.tx.adminInfo.type===$scope.adminInfo.issue_key_revoke.type},$scope.outputHasValue=function(){return function(item){return item.value>0}},$scope.findThis=function(){_findTx($routeParams.txId)},$scope.load=function(from){$scope.loadedBy=from,$scope.loadMore()},$scope.loadMore=function(){pagesTotal>pageNum&&!$scope.loading&&($scope.loading=!0,"address"===$scope.loadedBy?_byAddress():_byBlock())},(">"==$routeParams.v_type||"<"==$routeParams.v_type)&&($scope.from_vin="<"==$routeParams.v_type?!0:!1,$scope.from_vout=">"==$routeParams.v_type?!0:!1,$scope.v_index=parseInt($routeParams.v_index),$scope.itemsExpanded=!0),$scope.txs=[],$scope.$on("tx",function(event,txid){_findTx(txid)})}]),angular.module("insight.transactions").controller("SendRawTransactionController",["$scope","$http",function($scope,$http){$scope.transaction="",$scope.status="ready",$scope.txid="",$scope.error=null,$scope.formValid=function(){return!!$scope.transaction},$scope.send=function(){var postData={rawtx:$scope.transaction};$scope.status="loading",$http.post(window.apiPrefix+"/tx/send",postData).then(function(data,status,headers,config){return"string"!=typeof data.txid?($scope.status="error",void($scope.error="The transaction was sent but no transaction id was got back")):($scope.status="sent",void($scope.txid=data.txid))})["catch"](function(error){$scope.status="error",error?$scope.error=error:$scope.error="No error message given (connection error?)"})}}]),angular.module("insight.transactions").controller("DecodeRawTransactionController",["$scope","$http",function($scope,$http){$scope.transaction="",$scope.decodedTx=null,$scope.status="ready",$scope.error=null,$scope.formValid=function(){return!!$scope.transaction},$scope.clean=function(){$scope.decodedTx=null},$scope.decode=function(){var postData={rawtx:$scope.transaction};$scope.status="loading",$http.post(window.apiPrefix+"/tx/decodeRawTx",postData).then(function(data,status,headers,config){$scope.status="ready",$scope.decodedTx=JSON.stringify(data,null,2)})["catch"](function(err){$scope.status="error",err?$scope.error=err:$scope.error="No error message given (connection error?)"})}}]),angular.module("insight.validators").controller("ValidatorsController",["$scope","AdminInfo",function($scope,AdminInfo){$scope.validators=[],AdminInfo.get({},function(result){$scope.validators=result.validators})}]),angular.module("insight.address").factory("Address",["$resource",function($resource){return $resource(window.apiPrefix+"/addr/:addrStr/?noTxList=1",{addrStr:"@addStr"},{get:{method:"GET",interceptor:{response:function(res){return res.data},responseError:function(res){return 404===res.status?res:void 0}}}})}]),angular.module("insight.blocks").factory("Block",["$resource",function($resource){return $resource(window.apiPrefix+"/block/:blockHash",{blockHash:"@blockHash"},{get:{method:"GET",interceptor:{response:function(res){return res.data},responseError:function(res){return 404===res.status?res:void 0}}}})}]).factory("Blocks",["$resource",function($resource){return $resource(window.apiPrefix+"/blocks")}]).factory("LatestBlocks",["$resource",function($resource){return $resource(window.apiPrefix+"/blocks/latest",{},{get:{method:"GET",timeout:45e3}})}]).factory("BlockByHeight",["$resource",function($resource){return $resource(window.apiPrefix+"/block-index/:blockHeight")}]),angular.module("insight.currency").factory("Currency",["$resource",function($resource){return $resource(window.apiPrefix+"/currency")}]),angular.module("insight.system").factory("Global",[function(){var module={};return module.info={},module}]).factory("Version",["$resource",function($resource){return $resource(window.apiPrefix+"/version")}]),angular.module("insight.notify").factory("NotifyService",["$timeout","$http","$compile","$templateCache","$rootScope",function($timeout,$http,$compile,$templateCache,$rootScope){var templates={info:"views/notifications/notification-info.html",error:"views/notifications/notification-error.html",success:"views/notifications/notification-success.html"},startTop=75,verticalSpacing=15,duration=5e3,defaultType="info",position="center",container=document.body,messageElements=[],Notifier=function(){};return Notifier.prototype.notify=function(args){"object"!=typeof args&&(args={message:args}),args.type=args.type||defaultType,args.position=args.position||position,args.container=args.container||container,args.classes=args.classes||"",args.duration=args.duration||duration;var scope=args.scope?args.scope.$new():$rootScope.$new();scope.$message=args.message,scope.$classes=args.classes;try{$http.get(templates[args.type],{cache:$templateCache}).then(function(response){function layoutMessages(){for(var currentY=startTop,i=messageElements.length-1;i>=0;i--){var shadowHeight=10,element=messageElements[i],height=element[0].offsetHeight,top=currentY+height+shadowHeight;element.attr("data-closing")?top+=20:currentY+=height+verticalSpacing,element.css("top",top+"px").css("margin-top","-"+(height+shadowHeight)+"px").css("visibility","visible")}}var templateElement=$compile(response.data)(scope);templateElement.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",function(e){("opacity"===e.propertyName||e.originalEvent&&"opacity"===e.originalEvent.propertyName)&&(templateElement.remove(),messageElements.splice(messageElements.indexOf(templateElement),1),layoutMessages())}),angular.element(args.container).append(templateElement),messageElements.push(templateElement),"center"===args.position&&$timeout(function(){templateElement.css("margin-left","-"+templateElement[0].offsetWidth/2+"px")}),scope.$close=function(){templateElement.css("opacity",0).attr("data-closing","true"),layoutMessages(),scope.$destroy()},$timeout(function(){layoutMessages()}),args.duration>0&&$timeout(function(){scope.$close()},args.duration)},function(data){throw new Error("Template specified for cgNotify ("+args.type+") could not be loaded. "+data)})}catch(error){console.log("Error loading the notification template: ",error.message)}var retVal={};return retVal.close=function(){scope.$close&&scope.$close()},Object.defineProperty(retVal,"message",{get:function(){return scope.$message},set:function(val){scope.$message=val}}),retVal},Notifier.prototype.config=function(args){startTop=angular.isUndefined(args.startTop)?startTop:args.startTop,verticalSpacing=angular.isUndefined(args.verticalSpacing)?verticalSpacing:args.verticalSpacing,duration=angular.isUndefined(args.duration)?duration:args.duration,defaultType=args.type?args.type:defaultType,position=angular.isUndefined(args.position)?position:args.position,container=args.container?args.container:container},Notifier.prototype.closeAll=function(){for(var i=messageElements.length-1;i>=0;i--){var element=messageElements[i];element.css("opacity",0)}},{notify:function(args){return(new Notifier).notify(args)},success:function(msg,duration){var params={type:"success",message:msg,duration:duration};return this.notify(params)},successHandler:function(msg){var args={type:"success",message:msg},self=this;return function(){return self.notify(args)}},error:_.debounce(function(msg){var params={type:"error",message:_.capitalize(msg)};return this.notify(params)},1e3),errorHandler:function(error){var args={type:"error",message:_.capitalize(error.error)};return(new Notifier).notify(args)},info:function(msg){var params={type:"info",message:msg};return this.notify(params)},closeAll:function(){return(new Notifier).closeAll()}}}]);var ScopedSocket=function(socket,$rootScope){this.socket=socket,this.$rootScope=$rootScope,this.listeners=[]};ScopedSocket.prototype.removeAllListeners=function(opts){opts||(opts={});for(var i=0;i<this.listeners.length;i++){var details=this.listeners[i];opts.skipConnect&&"connect"===details.event||this.socket.removeListener(details.event,details.fn)}this.listeners=[]},ScopedSocket.prototype.on=function(event,callback){var socket=this.socket,$rootScope=this.$rootScope,wrapped_callback=function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})};socket.on(event,wrapped_callback),this.listeners.push({event:event,fn:wrapped_callback})},ScopedSocket.prototype.emit=function(event,data,callback){var socket=this.socket,$rootScope=this.$rootScope,args=Array.prototype.slice.call(arguments);args.push(function(){var args=arguments;$rootScope.$apply(function(){callback&&callback.apply(socket,args)})}),socket.emit.apply(socket,args)},angular.module("insight.socket").factory("getSocket",["$rootScope",function($rootScope){var socket=io.connect(null,{reconnect:!0,"reconnection delay":500});return function(scope){var scopedSocket=new ScopedSocket(socket,$rootScope);return scope.$on("$destroy",function(){scopedSocket.removeAllListeners()}),socket.on("connect",function(){scopedSocket.removeAllListeners({skipConnect:!0})}),scopedSocket}}]),angular.module("insight.status").factory("Status",["$resource",function($resource){return $resource(window.apiPrefix+"/status",{q:"@q"})}]).factory("Sync",["$resource",function($resource){return $resource(window.apiPrefix+"/sync")}]).factory("PeerSync",["$resource",function($resource){return $resource(window.apiPrefix+"/peer")}]).factory("AdminInfo",["$resource",function($resource){return $resource(window.apiPrefix+"/adminInfo")}]),angular.module("insight.transactions").factory("Transaction",["$resource",function($resource){return $resource(window.apiPrefix+"/tx/:txId",{txId:"@txId"},{get:{method:"GET",interceptor:{response:function(res){return res.data},responseError:function(res){return 404===res.status?res:void 0}}}})}]).factory("TransactionsByBlock",["$resource",function($resource){return $resource(window.apiPrefix+"/txs",{block:"@block"})}]).factory("TransactionsByAddress",["$resource",function($resource){return $resource(window.apiPrefix+"/txs",{address:"@address"})}]).factory("Transactions",["$resource",function($resource){return $resource(window.apiPrefix+"/txs")}]).factory("LatestTransactions",["$resource",function($resource){return $resource(window.apiPrefix+"/txs/latest",{},{get:{method:"GET",timeout:45e3}})}]);var ZeroClipboard=window.ZeroClipboard;angular.module("insight").directive("scroll",["$window",function($window){return function(scope,element,attrs){angular.element($window).bind("scroll",function(){this.pageYOffset>=200?scope.secondaryNavbar=!0:scope.secondaryNavbar=!1,scope.$apply()})}}]).directive("whenScrolled",["$window",function($window){return{restric:"A",link:function(scope,elm,attr){var pageHeight,clientHeight,scrollPos;$window=angular.element($window);var handler=function(){pageHeight=window.document.documentElement.scrollHeight,clientHeight=window.document.documentElement.clientHeight,scrollPos=window.pageYOffset,pageHeight-(scrollPos+clientHeight)===0&&scope.$apply(attr.whenScrolled)};$window.on("scroll",handler),scope.$on("$destroy",function(){return $window.off("scroll",handler)})}}}]).directive("clipCopy",function(){return ZeroClipboard.config({moviePath:"/lib/zeroclipboard/ZeroClipboard.swf",trustedDomains:["*"],allowScriptAccess:"always",forceHandCursor:!0}),{restric:"A",scope:{clipCopy:"=clipCopy"},template:'<div class="tooltip fade right in"><div class="tooltip-arrow"></div><div class="tooltip-inner">Copied!</div></div>',link:function(scope,elm){var clip=new ZeroClipboard(elm);clip.on("load",function(client){var onMousedown=function(client){client.setText(scope.clipCopy)};client.on("mousedown",onMousedown),scope.$on("$destroy",function(){client.off("mousedown",onMousedown)})}),clip.on("noFlash wrongflash",function(){return elm.remove()})}}}).directive("focus",["$timeout",function($timeout){return{scope:{trigger:"@focus"},link:function(scope,element){scope.$watch("trigger",function(value){"true"===value&&$timeout(function(){element[0].focus()})})}}}]).directive("loadingDots",function(){return{restrict:"AE",replace:!0,template:'<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span>'}}).directive("includeHeader",function(){return{restrict:"E",replace:!0,templateUrl:"views/includes/header.html"}}).directive("includeFooter",function(){return{restrict:"E",replace:!0,templateUrl:"views/includes/footer.html"}}).directive("includeConnection",function(){return{restrict:"E",replace:!0,templateUrl:"views/includes/connection.html"}}).directive("includeTxDetail",function(){return{restrict:"E",replace:!0,templateUrl:"views/transaction/txDetail.html"}}).directive("includeIssuanceTxDetail",function(){return{restrict:"E",replace:!0,templateUrl:"views/transaction/issuance/txDetail.html"}}).directive("includeKeysTxDetail",function(){return{restrict:"E",replace:!0,templateUrl:"views/transaction/addOrRemoveKeys/txDetail.html"}}).directive("includeBlockList",function(){return{restrict:"E",replace:!0,templateUrl:"views/transaction/blockList.html"}}).directive("includeSearch",function(){return{restrict:"E",replace:!0,templateUrl:"views/includes/search.html"}}).directive("includeAddressList",function(){return{restrict:"E",replace:!0,templateUrl:"views/transaction/addressList.html"}}),angular.module("insight").filter("startFrom",function(){return function(input,start){return start=+start,input.slice(start)}}).filter("split",function(){return function(input,delimiter){var delimiter=delimiter||",";return input.split(delimiter)}}).filter("coinFormatFilter",["Global",function(Global){return function(value,showCoin,trimValue){return showCoin?value+" "+(Global.info.testnet?"TRMG":"RMG"):(trimValue&&(value=value.toFixed(4)),value)}}]),angular.module("insight").config(["$routeProvider",function($routeProvider){$routeProvider.when("/block/:blockHash",{templateUrl:"views/block.html",title:"RMG Block "}).when("/tx/:txId/:v_type?/:v_index?",{templateUrl:"views/transaction.html",title:"RMG Transaction "}).when("/",{templateUrl:"views/landing.html",title:"Home"}).when("/address/:addrStr",{templateUrl:"views/address.html",title:"RMG Address "}).when("/about",{templateUrl:"views/about.html",title:"About"}).when("/tools",{templateUrl:"views/tools.html",title:"Tools"}).when("/validators",{templateUrl:"views/validators.html",title:"Validators"}).otherwise({templateUrl:"views/404.html",title:"Error"})}]),angular.module("insight").config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0),$locationProvider.hashPrefix("!")}]).constant("networks",{mainnet:{url:"//localhost:3001/insight"
},testnet:{url:"//localhost:3001/insight"}}).config(["RavenProvider",function(RavenProvider){Raven.config("https://da5bfb722ec544ccb9fa29a0d1f6ca67@sentry.io/204716",{}).install()}]).run(["$rootScope","$route","$location","$routeParams","$anchorScroll","ngProgress","amMoment","Status","Global",function($rootScope,$route,$location,$routeParams,$anchorScroll,ngProgress,amMoment,Status,Global){$rootScope.$on("$routeChangeStart",function(){ngProgress.start()}),$rootScope.$on("$routeChangeSuccess",function(){ngProgress.complete(),$rootScope.titleDetail="",$rootScope.title=$route.current.title,$rootScope.isCollapsed=!0,$rootScope.currentAddr=null,$location.hash($routeParams.scrollTo),$anchorScroll()}),Status.get({getInfo:!0},function(res){Global.info=res.info})}]),angular.element(document).ready(function(){});